# ğŸ¤ AI ìŒì„± ì¸ì‹ WebSocket ì„œë²„ (Unreal ì—°ë™ìš©)

> ì´ ë¬¸ì„œëŠ” íŒ€ í”„ë¡œì íŠ¸ìš© STT(WebSocket) ì„œë²„ë¥¼ ì²˜ìŒë¶€í„° ë”°ë¼í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±í•œ **ì „ì²´ íŠœí† ë¦¬ì–¼ README**ì…ë‹ˆë‹¤.
>
> **ê²Œì„(ì–¸ë¦¬ì–¼)**ê³¼ì˜ í˜‘ì—… í¬ì¸íŠ¸ë„ í•¨ê»˜ ì•ˆë‚´í•©ë‹ˆë‹¤.

---

## ğŸ“ í´ë” êµ¬ì¡°
```
ai_ws_server/
â”œâ”€â”€ test_audio/                 # í…ŒìŠ¤íŠ¸ìš© ìŒì„± wav íŒŒì¼
â”‚   â””â”€â”€ mom.wav
â”œâ”€â”€ client_test.py             # ë¡œì»¬ì—ì„œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ WebSocket í´ë¼ì´ì–¸íŠ¸
â”œâ”€â”€ main.py                    # FastAPI ê¸°ë°˜ WebSocket ì„œë²„ (STT ì²˜ë¦¬ í•µì‹¬)
â”œâ”€â”€ stt_model.py               # Whisper ëª¨ë¸ ë¡œë“œ ë° í…ìŠ¤íŠ¸ ë³€í™˜ ë¡œì§
â”œâ”€â”€ utils.py                   # ì˜¤ë””ì˜¤ ì €ì¥ ë„êµ¬ (raw â†’ .wav)
â”œâ”€â”€ requirements.txt           # ì„¤ì¹˜ íŒ¨í‚¤ì§€ ëª©ë¡
â””â”€â”€ README.md                # (ë°”ë¡œ ì´ ë¬¸ì„œ)
```

---

## ğŸŒ ì‹œìŠ¤í…œ ê°œìš”

### âœ… ì–´ë–¤ í†µì‹ ?
- **WebSocket í†µì‹ **
- í´ë¼ì´ì–¸íŠ¸(ì–¸ë¦¬ì–¼ or Python) â†’ ì„œë²„ë¡œ **ìŒì„± í”„ë ˆì„ bytes** ì „ì†¡
- ì„œë²„ëŠ” Whisperë¡œ **STT ì²˜ë¦¬ í›„ í…ìŠ¤íŠ¸ë¡œ ì‘ë‹µ**

### âœ… íë¦„ ìš”ì•½
```
[ì–¸ë¦¬ì–¼ Mic] â†’ ìŒì„± ë…¹ìŒ (raw bytes)
        â””â”€â”€(ws.send_binary) â†’ FastAPI ì„œë²„ ìˆ˜ì‹ 
                            â””â”€â”€ Whisperë¡œ í…ìŠ¤íŠ¸ ë³€í™˜
                                         â””â”€â”€ ê²°ê³¼ í…ìŠ¤íŠ¸ ì‘ë‹µ
```

---

## âš™ï¸ ì„œë²„ ì‹¤í–‰ë²• (FastAPI + Uvicorn)

### 1. ê°€ìƒí™˜ê²½ ìƒì„± (ì„ íƒ)
```bash
conda create -n ws-env python=3.10
conda activate ws-env
```

### 2. í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
```bash
pip install -r requirements.txt
```

#### requirements.txt ì˜ˆì‹œ:
```
fastapi
uvicorn
openai-whisper
soundfile
websockets
```

### 3. ì„œë²„ ì‹¤í–‰
```bash
uvicorn main:app --host 0.0.0.0 --port 8018 --reload
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ë°©ë²• (ë¡œì»¬ìš© client)

### `client_test.py` ì‹¤í–‰
```bash
python client_test.py
```
- ë‚´ë¶€ì— ì§€ì •ëœ `.wav` íŒŒì¼ì„ ì—´ê³ 
- WebSocketìœ¼ë¡œ ì„œë²„ì— ì „ì†¡í•˜ê³ 
- ì‘ë‹µ í…ìŠ¤íŠ¸ ì¶œë ¥

### ì£¼ì˜ì‚¬í•­
- `readframes()`ë¡œ ê°€ì ¸ì˜¨ PCM ë°ì´í„°ëŠ” `.wav` í˜•ì‹ì´ ì•„ë‹˜
- ì„œë²„ì—ì„œ `utils.py`ë¡œ **í—¤ë” ì¶”ê°€ ë˜í•‘ í›„ ì €ì¥** í•„ìš” (ì´ í”„ë¡œì íŠ¸ëŠ” ì´ë¯¸ êµ¬í˜„ë¨)

---

## ğŸ•¹ï¸ ê²Œì„ë°˜ ìš”ì²­ì‚¬í•­ (ì–¸ë¦¬ì–¼ ì¸¡ ì‘ì—…)

### ğŸ¯ Unrealì´ í•´ì•¼ í•  ê²ƒ
- ë§ˆì´í¬ ì…ë ¥ì„ í†µí•´ **raw PCM bytes** íšë“
- WebSocketìœ¼ë¡œ **binary í˜•ì‹ ì „ì†¡**
- ìˆ˜ì‹ ëœ í…ìŠ¤íŠ¸ë¥¼ HUD, í€˜ìŠ¤íŠ¸ ì‹œìŠ¤í…œ ë“±ì— ì—°ê²°

### ğŸ“© ë³´ë‚´ëŠ” ë°©ì‹ ëª…ì„¸ (ì–¸ë¦¬ì–¼ â†’ ì„œë²„)
- WebSocket URL: `ws://<ì„œë²„ IP>:8018/ws/audio`
- ë°ì´í„° íƒ€ì…: `binary`
- ì „ì†¡ ë‚´ìš©: `16bit / 16kHz / mono` ê¸°ì¤€ì˜ **raw PCM bytes**

### ğŸ“¬ ë°›ëŠ” í˜•ì‹ (ì„œë²„ â†’ ì–¸ë¦¬ì–¼)
- `text` ë©”ì‹œì§€ 1ê°œ
- ì¸ì‹ëœ ë¬¸ì¥ì´ ê·¸ëŒ€ë¡œ ë“¤ì–´ê°

### ì˜ˆì‹œ íë¦„
```json
[Send]  binary: b'\x1a\x32...'
[Recv]  text:   "ì •ë‹µì€ ì²­ê°œêµ¬ë¦¬ì…ë‹ˆë‹¤."
```

---

## ğŸ” ë””ë²„ê¹… íŒ

### ì„œë²„ì—ì„œ ë°›ì€ íŒŒì¼ ì§ì ‘ í™•ì¸
- `main.py` ì•ˆì— ì €ì¥ëœ `debug_XXXX.wav` ë¥¼ ë“¤ì–´ë³´ë©´ ê¹¨ì¡ŒëŠ”ì§€ íŒë‹¨ ê°€ëŠ¥
- ì •ìƒ ì¬ìƒ ì•ˆë˜ë©´ ì–¸ë¦¬ì–¼ ìª½ ì „ì†¡ ë¬¸ì œ ê°€ëŠ¥ì„± ë†’ìŒ

### Whisperê°€ "ì¸ì‹ ì‹¤íŒ¨"ë§Œ ë‚´ë†“ëŠ”ë‹¤ë©´?
- ì „ì†¡ëœ ë°ì´í„°ê°€ ê¹¨ì¡Œì„ ê°€ëŠ¥ì„± ë†’ìŒ
- í—¤ë” ì—†ëŠ” rawë¥¼ `.wav`ë¡œ ë³€í™˜í•˜ëŠ” ê³¼ì • (`utils.py`) í™•ì¸ í•„ìš”

---

## âœ… ì´ í”„ë¡œì íŠ¸ì˜ ëª©ì  ìš”ì•½
| í•­ëª© | ì„¤ëª… |
|------|------|
| ëª©í‘œ | ì‹¤ì‹œê°„ STTë¥¼ ê²Œì„ì— ì ‘ëª©ì‹œí‚¤ê¸° ìœ„í•œ ë°±ì—”ë“œ ì„œë²„ êµ¬ì¶• |
| ë°©ì‹ | WebSocket ê¸°ë°˜ í†µì‹ , Whisper STT ëª¨ë¸ í™œìš© |
| ì…ë ¥ | ì–¸ë¦¬ì–¼ ë˜ëŠ” í´ë¼ì—ì„œ ì „ì†¡í•œ ìŒì„± ë°ì´í„° (raw PCM) |
| ì¶œë ¥ | ì¸ì‹ëœ í…ìŠ¤íŠ¸ ë¬¸ìì—´ 1ì¤„ |

---

## ğŸ‘¥ íŒ€ì› ì „ë‹¬ ì‹œ ìš”ì•½
> "ì´ ì„œë²„ëŠ” ìŒì„± ë°ì´í„°ë¥¼ WebSocketìœ¼ë¡œ ë°›ìœ¼ë©´ Whisperë¡œ STT ì²˜ë¦¬í•´ì„œ í…ìŠ¤íŠ¸ë¥¼ ëŒë ¤ì£¼ëŠ” ë°±ì—”ë“œì•¼. ì–¸ë¦¬ì–¼ ìª½ì€ ë§ˆì´í¬ë¡œ ë°›ì€ raw PCMì„ binaryë¡œ ì „ì†¡ë§Œ í•´ì¤˜."

---

## ğŸ”— ì°¸ê³ 
- [OpenAI Whisper GitHub](https://github.com/openai/whisper)
- [FastAPI WebSocket Docs](https://fastapi.tiangolo.com/advanced/websockets/)

